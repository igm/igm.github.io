<!doctype html><html lang=en><head><meta charset=utf-8><link rel=stylesheet type=text/css media=screen href=//cdnjs.cloudflare.com/ajax/libs/fancybox/1.3.4/jquery.fancybox-1.3.4.css><link rel=stylesheet href=https://igormihalik.com/css/page.css><title>SockJS for Go II (lessons learned)</title></head><body><div class=content><h1>SockJS for Go II (lessons learned)</h1><script id=dsq-count-scr src=//igormihalik.disqus.com/count.js async></script><p>It&rsquo;s been a while since implementing SockJS library for Go. Since then I learned couple of new things about the language and runtime. So here I&rsquo;ll try to summarise what it was.</p><p>You can run it here. In the output you&rsquo;ll see 2 routines. Notice routine 2 in &ldquo;chan send&rdquo; state. It is trying to send to the channel but that operation is never going to happen. And that is exactly what happened in my routines here and here. One of the solution is to make channel &ldquo;buffered&rdquo;. In this specific case it is enough to set buffer length to 1:</p><p>Other option would be to close the channel but that has different consequences (you can try it yourself and see what happens).</p><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://blog.igormihalik.com",this.page.identifier="/post/sockjs-for-go-ii-lessons-learned/"};(function(){var a=document,b=a.createElement('script');b.src='//igormihalik.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><script type=text/javascript src=//code.jquery.com/jquery-1.11.0.min.js></script><script type=text/javascript src=//code.jquery.com/jquery-migrate-1.2.1.min.js></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/fancybox/1.3.4/jquery.fancybox-1.3.4.pack.min.js></script><script type=text/javascript>$(function(a){var b=!1,c=!0,d='inside';a(b?'img':'img.fancybox').each(function(){var b=a(this),c=b.attr('title'),d=b.attr('data-big')||b.attr('src'),e=a('<a href="#" class="fancybox"></a>').attr('href',d).attr('title',c);b.wrap(e)}),c&&a('a.fancybox').attr('rel','fancyboxgallery'),a('a.fancybox').fancybox({titlePosition:d})}),$.noConflict()</script></body></html>